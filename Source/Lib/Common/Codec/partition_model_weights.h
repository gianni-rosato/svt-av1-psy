/*
 * Copyright (c) 2018, Alliance for Open Media. All rights reserved
 *
 * This source code is subject to the terms of the BSD 2 Clause License and
 * the Alliance for Open Media Patent License 1.0. If the BSD 2 Clause License
 * was not distributed with this source code in the LICENSE file, you can
 * obtain it at www.aomedia.org/license/software. If the Alliance for Open
 * Media Patent License 1.0 was not distributed with this source code in the
 * PATENTS file, you can obtain it at www.aomedia.org/license/patent.
 */

#ifndef AOM_AV1_ENCODER_PARTITION_MODEL_WEIGHTS_H_
#define AOM_AV1_ENCODER_PARTITION_MODEL_WEIGHTS_H_

#ifdef __cplusplus
extern "C" {
#endif

#include "ml.h"

// nn model for predicting max square partition level of a superblock
#define NUM_HIDDEN_LAYERS 1
#define NUM_FEATURES 13
#define NUM_LAYER_0_UNITS 48
#define NUM_LOGITS 4

static const float av1_max_part_pred_logits_kernel[] = {
  -0.304561f,   0.0885596f,   -0.988539f,   1.08147f,    0.215213f,
  0.202965f,    -0.828457f,   -0.233945f,   -0.0866977f, -0.115521f,
  0.02079f,     0.196491f,    -0.0285075f,  0.05067f,    -0.00872862f,
  0.00281844f,  -0.238954f,   0.0253801f,   0.0257775f,  0.339269f,
  0.176174f,    -0.152545f,   -0.0588704f,  -1.62275f,   -0.189329f,
  0.0808033f,   0.233844f,    -4.53798f,    0.674968f,   -0.0361688f,
  -0.0754075f,  1.16129f,     -0.0188879f,  0.113255f,   -3.04378f,
  0.814728f,    -0.568517f,   -0.00179383f, -3.61223f,   -1.67535f,
  -2.20417f,    -0.197196f,   0.0507745f,   -0.0909394f, -0.0507879f,
  -1.27999f,    -0.055623f,   0.0318497f,   0.192867f,   0.138726f,
  0.0443392f,   -0.595075f,   -0.166774f,   0.0882958f,  -0.348161f,
  0.0214428f,   -0.0599275f,  -0.0995385f,  -0.82358f,   0.141205f,
  -0.053232f,   0.00508296f,  -1.90872f,    1.15004f,    -0.194219f,
  0.0229019f,   -0.00354318f, 0.22016f,     0.154101f,   -0.159231f,
  -0.0446647f,  -0.197503f,   0.0408453f,   0.197659f,   0.797858f,
  -0.189722f,   0.343653f,    0.124666f,    -1.03083f,   0.603059f,
  0.101565f,    0.0932993f,   0.462484f,    0.295984f,   1.11198f,
  0.143709f,    -0.846232f,   -0.464392f,   -1.06058f,   -0.124889f,
  0.0727475f,   1.18446f,     -0.100302f,   0.0641918f,  -0.101622f,
  0.10219f,     0.130189f,    0.0915623f,   -0.166904f,  -1.10606f,
  -0.16726f,    -0.146152f,   0.145443f,    -0.177091f,  -0.0215214f,
  0.0158506f,   -0.553294f,   0.0784749f,   -0.0416628f, -0.027785f,
  0.280027f,    0.484898f,    -0.164225f,   0.0238317f,  -0.0345254f,
  0.0410244f,   0.131529f,    0.0239622f,   -0.0749436f, -0.0224914f,
  0.128926f,    0.224539f,    0.413297f,    0.0638572f,  0.103308f,
  0.0913242f,   -0.119274f,   0.0163103f,   0.113828f,   0.119809f,
  0.297057f,    -0.124889f,   -0.533108f,   -0.181408f,  -0.129896f,
  0.0221064f,   -0.0773281f,  -0.0386467f,  0.0342961f,  0.126575f,
  -0.24114f,    0.0735576f,   0.0524791f,   0.246896f,   -0.130674f,
  -0.03979f,    0.173639f,    1.95193f,     -0.113029f,  -0.0305852f,
  -0.00671737f, 0.157159f,    -0.00102858f, -0.543688f,  0.566772f,
  0.124124f,    -0.0294064f,  -0.0699021f,  -0.0704103f, -0.766097f,
  -0.0625802f,  -0.0906173f,  -0.0520414f,  -0.0272724f, 0.283064f,
  0.236213f,    -0.127319f,   0.019392f,    0.170042f,   -0.0214542f,
  0.0740938f,   0.356578f,    -0.236257f,   0.269021f,   0.114759f,
  -0.641166f,   0.136308f,    -0.0386959f,  -0.112024f,  -0.361209f,
  0.686095f,    0.183906f,    0.288656f,    0.182007f,   0.337458f,
  0.058974f,    -0.305512f,   -0.841708f,   -0.243779f,  -0.0614058f,
  0.208747f,    0.448697f
};

static const float av1_max_part_pred_layer_0_bias[] = {
  -0.776544f, -2.0022f,    -0.330294f, 2.47665f,  1.90206f,   -1.61571f,
  0.536246f,  1.00455f,    5.24561f,   1.55111f,  -0.816399f, -4.88703f,
  -1.06417f,  -1.15359f,   -0.145289f, 1.91831f,  0.630915f,  -1.94256f,
  -3.35239f,  -1.05007f,   -1.05186f,  1.36824f,  -5.2878f,   1.10482f,
  -5.00077f,  -0.0445198f, 3.41427f,   2.3439f,   -0.413306f, -1.88152f,
  -2.28638f,  8.24783f,    -1.91961f,  -1.49324f, 1.96599f,   -6.32309f,
  -0.332426f, -0.425506f,  4.06511f,   5.84386f,  4.15747f,   1.22402f,
  2.8512f,    2.53027f,    0.0170272f, -1.43966f, -0.997785f, 5.43064f
};

static const float av1_max_part_pred_logits_bias[] = { -4.25432f, 0.144758f,
                                                       1.96217f, 0.728905f };

static const float av1_max_part_pred_layer_0_kernel[] = {
  0.992471f,    0.533006f,    0.143743f,     -2.51788f,    -0.468337f,
  -0.201376f,   -0.151834f,   0.479883f,     1.16061f,     -0.278878f,
  -0.814954f,   -0.152405f,   -0.0521608f,   0.797104f,    -2.08912f,
  0.385839f,    -2.22889f,    -0.106858f,    -0.239766f,   -0.951128f,
  -0.698753f,   0.0831051f,   1.1702f,       0.342834f,    -0.0352795f,
  -0.0847639f,  -0.802086f,   0.258982f,     1.14174f,     0.645885f,
  -1.19226f,    -0.592888f,   -0.343659f,    1.1912f,      1.45411f,
  -1.22927f,    0.152858f,    0.00373585f,   -1.60637f,    0.592611f,
  0.0857475f,   -0.346147f,   -0.150784f,    -0.0817408f,  -0.189918f,
  -0.804952f,   -1.33036f,    -1.03307f,     0.0248769f,   0.16607f,
  -2.896f,      -2.1293f,     0.12293f,      -0.173179f,   -0.212128f,
  -6.76221f,    0.033188f,    0.0231787f,    0.905957f,    0.0551327f,
  -0.356276f,   0.0181795f,   0.0977523f,    -0.0352873f,  -0.0396386f,
  2.3241f,      0.0632874f,   -0.11804f,     -6.32521f,    0.0224659f,
  -0.00188896f, 0.267992f,    0.272337f,     0.00936963f,  0.659969f,
  -2.25707f,    -0.0278229f,  -0.0185089f,   -1.14466f,    0.104827f,
  0.0435885f,   0.558586f,    -0.00697004f,  0.0312611f,   0.540574f,
  -0.568625f,   0.218608f,    0.378911f,     -0.0289192f,  -0.0734742f,
  -1.08782f,    -2.42069f,    -0.0127239f,   0.0493651f,   -1.15837f,
  0.261831f,    0.401824f,    -1.04545f,     0.284173f,    0.784972f,
  -0.511243f,   -0.982599f,   -0.106134f,    -0.325964f,   -1.44107f,
  -1.42434f,    -1.02402f,    -1.52034f,     0.0737116f,   0.0462242f,
  0.628722f,    -1.0405f,     -0.113718f,    2.20573f,     -4.33951f,
  -0.0192695f,  -0.0229314f,  -1.89156f,     0.645942f,    0.375708f,
  -1.97447f,    -0.267014f,   0.0989443f,    -0.450534f,   -1.01737f,
  -0.642416f,   -0.0897288f,  -2.08724f,     -0.190965f,   -0.279135f,
  -0.830178f,   0.808754f,    -0.139091f,    1.11004f,     -0.454439f,
  -0.479238f,   -1.44001f,    0.0888059f,    0.885689f,    -0.642505f,
  -0.00773651f, -0.0265721f,  -0.906346f,    1.68504f,     0.084257f,
  -0.951101f,   -8.06495f,    0.19231f,      0.16389f,     -0.193678f,
  0.729837f,    -1.98392f,    -5.98513f,     3.32638f,     -0.0658378f,
  -0.0910426f,  -0.666567f,   -0.315339f,    0.123124f,    -2.66375f,
  -0.714852f,   -0.136176f,   -0.460166f,    -0.567551f,   -1.06193f,
  -1.21389f,    -0.83865f,    0.00280695f,   -0.199519f,   -0.534704f,
  0.419311f,    -0.149008f,   -3.68707f,     0.00285113f,  -0.0718198f,
  -1.41026f,    -1.34155f,    -0.538687f,    -0.623666f,   -2.56462f,
  -0.0183333f,  -0.323532f,   -1.27141f,     -0.0212039f,  0.198633f,
  0.459554f,    -4.65103f,    -1.01293f,     -1.39512f,    -0.289026f,
  0.208724f,    -0.665226f,   1.13369f,      -1.96734f,    -1.45442f,
  -3.46172f,    0.810681f,    -0.603973f,    0.842764f,    -3.90371f,
  -0.394561f,   -3.61363f,    -2.88085f,     0.031645f,    -0.23125f,
  -2.63898f,    -1.35314f,    -0.46726f,     1.33145f,     1.20269f,
  1.38682f,     -0.331637f,   0.069021f,     0.149523f,    -1.24957f,
  -0.878857f,   -0.200368f,   0.465744f,     1.01365f,     -0.0122221f,
  -0.550586f,   -1.12581f,    -0.422132f,    -0.0744868f,  -2.4804f,
  -1.07072f,    -0.479006f,   0.101817f,     -0.118947f,   0.341576f,
  -1.0538f,     -0.812346f,   -1.13727f,     -0.00939806f, 10.1571f,
  -0.0441302f,  0.00280407f,  -21.5044f,     0.0181152f,   -0.0143246f,
  3.23462f,     -1.38624f,    -1.80416f,     4.89763f,     -2.67364f,
  2.31771e-05f, 0.000393989f, 0.352204f,     -0.193455f,   0.531455f,
  0.488757f,    -0.442555f,   -0.518528f,    0.431482f,    -2.67727f,
  -2.00626f,    -0.39729f,    -0.221494f,    -0.0188888f,  -0.0377649f,
  -1.80169f,    0.0810332f,   -0.0408335f,   -1.28675f,    -0.0353824f,
  -0.666723f,   -1.07281f,    0.252912f,     -1.24547f,    -1.7831f,
  -1.14354f,    -0.137662f,   0.00230182f,   0.736862f,    0.175872f,
  -0.187556f,   0.43963f,     -0.796524f,    0.056219f,    -0.387874f,
  0.0710224f,   -0.16548f,    -0.100993f,    0.931481f,    -3.20738f,
  -0.0197576f,  0.266148f,    -0.173909f,    -0.337795f,   -0.0682381f,
  0.176844f,    0.140286f,    1.12033f,      0.429064f,    -2.24192f,
  -1.54682f,    2.23646f,     -0.0371138f,   -0.0475339f,  -3.21766f,
  0.0412858f,   0.387811f,    6.6711f,       0.140649f,    0.0559547f,
  -0.802839f,   0.599977f,    0.64552f,      -2.08103f,    -0.503401f,
  -0.0407036f,  -0.0299199f,  0.0849445f,    -0.111657f,   -1.63462f,
  3.33762f,     0.0441394f,   0.0466889f,    -0.951806f,   0.0723954f,
  0.00348661f,  -1.36903f,    2.24625f,      -0.0348915f,  -0.0508893f,
  -0.240891f,   -0.120143f,   -0.17991f,     -2.09137f,    0.0150871f,
  0.0480333f,   1.72012f,     0.0309551f,    -0.0370507f,  -0.377075f,
  0.103916f,    -0.0169255f,  -0.0145395f,   -4.02144f,    0.83193f,
  -0.316502f,   6.3832f,      -1.70038f,     -1.97215f,    -1.94501f,
  1.45479f,     0.711725f,    -0.348496f,    -0.279056f,   -1.13396f,
  -1.51744f,    -0.853307f,   1.53131f,      -0.0032358f,  1.41808f,
  -1.32989f,    -0.245221f,   -0.161614f,    -0.500845f,   -0.449252f,
  0.0724151f,   -0.116333f,   -0.0946182f,   -2.0945f,     0.0564572f,
  0.393261f,    -1.06861f,    -0.111458f,    -0.839943f,   -0.0880348f,
  0.0365742f,   0.415339f,    -1.57494f,     -0.713697f,   1.02349f,
  -0.221371f,   -0.0446281f,  1.89223f,      -0.0811754f,  -0.402773f,
  -0.930987f,   0.0243194f,   0.0678332f,    -0.0233014f,  0.165372f,
  -0.44083f,    -1.2404f,     0.35675f,      -0.040916f,   -0.0512548f,
  -2.9071f,     0.861174f,    -0.778133f,    2.14436f,     -0.688427f,
  -0.480371f,   -1.69032f,    0.706687f,     -0.281982f,   -2.30451f,
  1.61541f,     -0.0213638f,  -0.740509f,    -0.266677f,   0.0268434f,
  -0.0116908f,  -3.17595f,    0.0114825f,    0.0196997f,   -0.144005f,
  0.0550181f,   -0.851459f,   -0.000285073f, -0.538441f,   -0.0254868f,
  -0.0104454f,  -0.0661998f,  -0.196469f,    -0.346372f,   -5.52892f,
  -0.643683f,   -0.622224f,   -0.31463f,     -0.555956f,   -0.520132f,
  -0.843166f,   -2.59479f,    -0.750195f,    0.00635995f,  -0.338615f,
  -0.216676f,   -0.391544f,   -1.62185f,     -0.718471f,   -0.475406f,
  -0.782041f,   -0.608824f,   -1.09633f,     -1.27308f,    -0.560719f,
  -0.207539f,   -0.0196445f,  -1.05519f,     -0.575249f,   -1.0642f,
  1.01615f,     -0.873633f,   -0.417953f,    -0.428051f,   0.350259f,
  -2.53833f,    -2.72203f,    0.672846f,     -0.503094f,   -1.1374f,
  0.214291f,    0.013305f,    0.0112064f,    1.10532f,     0.030455f,
  0.0239614f,   0.628072f,    0.0539135f,    -0.472441f,   -0.688439f,
  -0.32044f,    -0.0234867f,  -0.0158436f,   -0.949314f,   -0.0453161f,
  -1.18306f,    0.626845f,    -0.426925f,    -0.688371f,   0.415062f,
  0.0640985f,   -0.638387f,   -2.01399f,     -0.209744f,   -0.762892f,
  -0.0753296f,  -0.879315f,   -0.520433f,    -0.111375f,   0.389742f,
  -0.398862f,   -0.643227f,   -0.246396f,    0.0317051f,   1.06973f,
  0.413617f,    0.180506f,    -0.0507897f,   -0.00650435f, 0.620892f,
  0.046312f,    0.475032f,    0.906993f,     -0.0388061f,  -0.256271f,
  -1.03323f,    0.0125266f,   -0.31116f,     -0.377611f,   -0.0386407f,
  -0.0232745f,  -0.353644f,   -2.27289f,     0.0571779f,   -0.00865006f,
  1.65101f,     0.0175711f,   0.0184585f,    0.558458f,    0.2213f,
  -0.285089f,   0.433445f,    -0.427177f,    -0.0103682f,  -0.0101273f,
  0.214085f,    -0.0459885f,  0.00761981f,   0.836381f,    0.0175293f,
  0.02508f,     -1.51778f,    0.0143956f,    -0.162589f,   0.595418f,
  0.21445f,     -0.0335848f,  -0.0136684f,   -0.16686f,    -0.14612f,
  0.0816238f,   0.499636f,    0.12458f,      -2.41673f,    -0.261721f,
  -0.676805f,   -1.88366f,    0.730462f,     0.69196f,     -0.0288489f,
  -2.38272f,    0.329876f,    0.014517f,     -0.115145f,   -3.48151f,
  -0.00209072f, -0.0732377f,  0.820443f,     -0.0118701f,  0.112145f,
  0.272315f,    0.137531f,    -0.0200997f,   -0.0397883f,  -2.19458f,
  0.183554f,    -0.639716f,   0.481605f,     -0.621639f,   -0.0980299f,
  -0.710534f,   -0.143105f,   -6.77626f,     -1.65139f,    -2.37718f,
  -0.533127f,   -1.12574f,    3.34182f,      -0.0758663f,  0.0334238f,
  -9.48647f,    0.0674974f,   0.0507665f,    0.523007f,    -0.0668f,
  0.5736f,      -0.589761f,   -1.1692f,      -0.0236497f,  -0.00828928f,
  -0.265823f,   1.15284f,     0.307927f,     -0.695308f,   0.13725f,
  -0.20394f,    -0.363965f,   -0.331159f,    -1.50927f,    -1.20051f,
  -0.0205825f,  -0.0381859f,  -0.0579876f,   -1.6913f,     -1.94626f,
  3.4214f,      3.3922f,      -2.13798f,     -0.679848f,   -0.890735f,
  0.235017f,    -0.253202f,   -1.0571f,      1.40354f,     0.00719052f,
  -1.54365f,    -0.7289f,     -1.05492f,     0.0238169f,   -0.00543592f,
  -0.0510353f,  -0.175386f,   -0.724207f,    -0.788936f,   0.039976f,
  1.36966f,     0.869475f,    -0.0302774f,   -0.0537556f
};

static const NN_CONFIG av1_max_part_pred_nn_config = {
  NUM_FEATURES,
  NUM_LOGITS,
  NUM_HIDDEN_LAYERS,
  {
      NUM_LAYER_0_UNITS,
  },
  {
      av1_max_part_pred_layer_0_kernel,
      av1_max_part_pred_logits_kernel,
  },
  {
      av1_max_part_pred_layer_0_bias,
      av1_max_part_pred_logits_bias,
  },
};

#undef FEATURES
#undef HIDDEN_NODES

#ifdef __cplusplus
}  // extern "C"
#endif

#endif  // AOM_AV1_ENCODER_PARTITION_MODEL_WEIGHTS_H_
